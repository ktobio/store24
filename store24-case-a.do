/**********************************************************************************File        : store24-case-a.do  <--- this should be the exact name of THIS documentAuthor      : Kristina Tobio Created     : 15 Nov 2016Modified    : 03 Feb 2017Description : .do file for Store24 Case Part A **********************************************************************************/// these commands prepare your computer for the data and analysis// this finds and closes open log filescapture log close        // this clears Stata's data memory so new data can be loadedclear       // this makes it so you don't have to keep pressing return/enter to scroll through resultsset more off          // this sets memory sizeset mem 100m       // this keeps everything visible on a normal monitor or laptop screenset linesize 200    // cd means "change directory"// you need to change this to the location on your computer where you are storing the .do and data files*cd "/Users/ktobio/Desktop/Jeff/Course/Store24/store24-case/"       // this creates a log file, which will record all of the commands and outputs from this .do file // log files should be placed in a folder named "logs" in your directory log using "logs/store24-case-a", replace// data should be placed in a folder named "data" in your directory // the data is in .csv (comma seperated values) format// this command reads the data into Stata*insheet using "data/store24-case-data.csv", names// code here that labels the variables?// save the data as a Stata dataset*save "data/store24-case-data.dta", replaceuse "data/PA_Store24A_data.dta"// A FIRST CUT AT THE DATA // displays summary statistics for a subset of variablessummarize sales profit mtenure ctenure pop comp visibility pedcount res hours24// display summary statistics for the the most profitable and least profitable stores// gsort sorts by the variable indicated// the negative sign before "profit" sorts in descending order (default is ascending order)gsort -profit// _n is the obervation number// because we have sorted profit in descending order, observations 1-10 are the most profitable stores// "list" lists the variables indicatedlist store profit mtenure ctenure if _n<=10// we can use "sort" to sort profit in ascending order; gsort without the negative sign would also worksort profit// because we have sorted profit in descending order, observations 1-10 are the least profitable storeslist store profit mtenure ctenure if _n<=10// PART ONE: TENURE MATTERS// Does manager tenure have an effect on profit? On sales?regress profit mtenureregress sales mtenure// What about crew tenure?regress profit ctenureregress sales ctenure// What about both?regress profit mtenure ctenureregress sales mtenure ctenure// What happens when we add control variables?regress profit mtenure ctenure pop comp visibility ped res hours24regress sales mtenure ctenure pop comp visibility ped res hours24// Benefit of Experience - Creating Standardized Coefficients// Re-run the profit regressionregress profit mtenure ctenure pop comp visibility ped res hours24// Summarize the variable mtenure, then capture the standard deviation in a local (temporary) variable// Note that "sum" is the same command as "summarize"sum mtenurelocal a=r(sd)// Here, we create a standardized coefficient for mtenure // The command _b[VARIABLE] captures the coefficient of VARIABLE in the most recent regressiong sco_mtenure=`a'*_b[mtenure]// We could create standardized coefficients for each of the remaining variables in the regression by retyping these 3 lines 7 more times// Or, we could use a loop, which saves us time and reduced visual clutter in our .do file// This loop takes each variable in the list and runs it through the three lines of code automaticallyforeach var in ctenure pop comp visibility ped res hours24 {sum `var'local a=r(sd)g sco_`var'=`a'*_b[`var']}// Here, we list the values of each our standardized coefficients// A "*" is a wild card, so this command tells Stata to list all the variables that begin with "sco_"list sco_* if _n==1//PART TWO: RELATIVE IMPORTANCE// The incremental R2 can help us to understand the relative importance of variables in the regressionregress profit mtenure ctenure pop comp visibility ped res hours24// The "e()" command allows you to capture regression results and put them into a variable.// Here, we capture the adjusted R2, but you can also capture statistics like the number of observations or the F-statistic// Type "help regress" for more detailg r2_full=e(r2_a)// We will use it to calculate the incremental R2 of mtenureregress profit ctenure pop comp visibility ped res hours24g ir2_mtenure=r2_full-e(r2_a)// We continue to drop variables from the regression in turn, and calculate each incremental R2regress profit mtenure pop comp visibility ped res hours24g ir2_ctenure=r2_full-e(r2_a)regress profit mtenure ctenure comp visibility ped res hours24g ir2_pop=r2_full-e(r2_a)regress profit mtenure ctenure pop visibility ped res hours24g ir2_comp=r2_full-e(r2_a)regress profit mtenure ctenure pop comp ped res hours24g ir2_visibility=r2_full-e(r2_a)regress profit mtenure ctenure pop comp visibility res hours24g ir2_ped=r2_full-e(r2_a)regress profit mtenure ctenure pop comp visibility ped hours24g ir2_res=r2_full-e(r2_a)regress profit mtenure ctenure pop comp visibility ped resg ir2_hours24=r2_full-e(r2_a)// We can examine the incremental R2 for each variable with the folloing commandlist ir2* if _n==1// Explaining Variation in Profit// To determine the percent of variation in profit NOT explined by our model, we subtract the adjusted R2 from 1g unexplained=1-r2_full// To determine the percent of variation in profit explained by people we add the incremental R2 of manager and crew tenuresg people=ir2_mtenure+ir2_ctenure// To determine the percent of variation in profit explained by site, we add the incremental R2 of population, competition,	// store front visibility, pedestrian foot traffic, residential location, and open 24 hours.g site=ir2_pop+ir2_comp+ir2_visibility+ir2_ped+ir2_res+ir2_hours24// To determine overlap, we subtract people and site from the full adjusted R2g overlap=r2_full-people-site// We can examine these results visually with a pie chartgraph pie overlap people site unexplain, plabel(_all percent) title(Explaining Variation in Profit)graph save "figures/pie", replace// PART THREE: DIMINISHING RETURNS// Create a new variable called MT2 that squares the manager tenure termg MT2=mtenure*mtenureregress profit mtenure ctenure pop comp visibility ped res hours24 MT2// because we created some new variables, we want to save this dataset in case we want to use it latersave "data/store24-case-data-new-variables.dta", replace// closes your loglog close// drops all data from Stata's memoryclear